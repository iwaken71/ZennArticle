---
title: "ã€HoloLens2ã€‘UE4.26ã§ImageTracking(QRCode)ã‚„ã£ã¦ã¿ãŸ"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["UnrealEngine","HoloLens","UE4","VisualStudio","Microsoft"]
published: true
---
# ã¯ã˜ã‚ã«

UE4ã¨HoloLens2ã§ImageTrackingã‚’è¡Œã„World Anchorã‚’ç½®ããŸã„ã¨ãã«ã¯ã€QRCode Trackingã‚’åˆ©ç”¨ã™ã‚‹ã—ã‹ãªã„ã‚ˆã†ã§ã™ã€‚ã‚‚ã—ã€ä»»æ„ã®ç”»åƒãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚’è¡Œã„ãŸã„å ´åˆã¯ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£è£½ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ç”¨ãŒå¿…è¦ã§ã™ã€‚ã¨ã„ã†ã“ã¨ã§ã€ã¾ãšã¯QRCode Trackingã‚’å­¦ã‚“ã§ã„ãã¾ã—ã‚‡ã†ã€‚

## å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸
![QRCode](https://user-images.githubusercontent.com/10010842/103849269-8b51e680-50e7-11eb-88a1-8268fb0c6d75.gif)

# å‚è€ƒè¨˜äº‹

https://docs.microsoft.com/ja-jp/windows/mixed-reality/develop/unreal/unreal-qr-codes?tabs=426

# é–‹ç™ºç’°å¢ƒ

- Windows10 Pro
- Unreal Engine4.26 (ä»¥ä¸‹Unreal)
- Visual Studio2019
- HoloLens2

# å‰æº–å‚™

ã“ã®è¨˜äº‹ã¯ã“ã¡ã‚‰ã®è¨˜äº‹ã®ç¶šãã¨ãªã‚Šã¾ã™ã€‚
https://zenn.dev/iwaken71/articles/6792badbdec8d6

ã“ã¡ã‚‰ã®è¨˜äº‹ã®
- Unrealãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
- å¿…è¦ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®æœ‰åŠ¹åŒ–
- æ–°ã—ã„ãƒ¬ãƒ™ãƒ«ã®ä½œæˆ
- è±†è…(Cube)ã‚’ãƒ¬ãƒ™ãƒ«ã«é…ç½®
- Mixed Realityç”¨ã®è¨­å®š
- PackageåŒ–ã®è¨­å®š

ã‚’ã™ã§ã«è¡Œã£ãŸçŠ¶æ…‹ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚

# æ‰‹é †

- QRæ¤œå‡ºã®æœ‰åŠ¹åŒ–
- Trackingã™ã‚‹QRã‚³ãƒ¼ãƒ‰ã®è¨­å®š
- Trackingã—ã¦ã„ã‚‹QRCodeã‚’æ´»ç”¨ã™ã‚‹
- å®Œæˆï¼Packageã—ã¦ç¢ºèª

# QRæ¤œå‡ºã®æœ‰åŠ¹åŒ–

- [Edit]>[Project Settings]>[Platforms]>[HoloLens]>[Capabilities]>[Webcam]ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹ã€‚
- ARSessionConfigã«é–¢ã—ã¦Start AR Sessionã‚’è¡Œã†
    - è©³ã—ãã¯[ã“ã¡ã‚‰](https://zenn.dev/iwaken71/articles/6792badbdec8d6#arsessionconfig%E3%81%AE%E8%A8%AD%E5%AE%9A)

UE4.26ã‚’ä½¿ã†éš›ã¯ã€Start AR Sessionã®å¾Œã«QRCodeæ¤œå‡ºã®åˆæœŸåŒ–å‡¦ç†ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚‹ãã†ã§ã™ã€‚
ãƒ¬ãƒ™ãƒ«ãƒ–ãƒ«ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã«é–¢ã—ã¦æ¬¡ã®å‡¦ç†ã‚’è¿½åŠ ã—ã¾ã™ã€‚

![image](https://user-images.githubusercontent.com/10010842/103845591-b46e7900-50df-11eb-9382-f25983974d0d.png)

# Trackingã™ã‚‹QRã‚³ãƒ¼ãƒ‰ã®è¨­å®š

- BluePrintã‚’æ–°ã—ãç”Ÿæˆã™ã‚‹
    - [Actor]ã‚’é¸æŠ
    - "BP_QRCodeTrackingManager"ã¨ã„ã†åå‰ã‚’ä»˜ã‘ã‚‹
- [ARTrackableNotify]ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹
- [ARTrackableNotify]ã‚’é¸æŠã—ã€[Details]ãƒ‘ãƒãƒ«ã®[Event]ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å±•é–‹ã™ã‚‹
- [On Update Tracked Geometry]ã‚’é¸æŠ

## BluePrintã‚’æ–°ã—ãç”Ÿæˆã™ã‚‹
![image](https://user-images.githubusercontent.com/10010842/103846063-b553da80-50e0-11eb-9320-62d129463349.png)

## [ARTrackableNotify]ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹/[On Update Tracked Geometry]ã‚’é¸æŠ
![image](https://user-images.githubusercontent.com/10010842/103846191-edf3b400-50e0-11eb-852d-d0f1a839337c.png)

# Trackingã—ã¦ã„ã‚‹QRCodeã‚’æ´»ç”¨ã™ã‚‹
![image](https://docs.microsoft.com/ja-jp/windows/mixed-reality/develop/unreal/images/qr-codes-img-02.png)
(å¼•ç”¨: https://docs.microsoft.com/ja-jp/windows/mixed-reality/develop/unreal/unreal-qr-codes?tabs=426)

ã“ã¡ã‚‰ã‚’æ´»ç”¨ã—ã¦ã€Cubeã‚’QRCodeã«é‡ã­ã‚‹å®Ÿè£…ã‚’ã—ã¾ã™ã€‚

BP_QRCodeTrackingManagerã‚’ç·¨é›†
- Variablesã®è¨­å®š
    - Variablesã‚’"Cube"ã¨ã„ã†åå‰ã§è¿½åŠ 
    - [Variable Type]ã‚’[Actor]ã«é¸æŠ
    - [Instance Editable]ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹
- æ—¢å­˜ã®Graphã«å›³ã®ã‚ˆã†ã«ã¤ãªã’ã‚‹

## Variablesã®è¨­å®š

![image](https://user-images.githubusercontent.com/10010842/103849073-2c8c6d00-50e7-11eb-89dd-c66e44586852.png)

## æ—¢å­˜ã®Graphã«å›³ã®ã‚ˆã†ã«ã¤ãªã’ã‚‹

![image](https://user-images.githubusercontent.com/10010842/103849212-74ab8f80-50e7-11eb-8f1f-7cd8c1b3a0c8.png)
![image](https://user-images.githubusercontent.com/10010842/103849328-b5a3a400-50e7-11eb-9092-18b4d4d42263.png)


# å®Œæˆï¼Packageã—ã¦ç¢ºèª

![QRCode](https://user-images.githubusercontent.com/10010842/103849269-8b51e680-50e7-11eb-88a1-8268fb0c6d75.gif)


